# UI Module (`frontend/src/ui`)

User interface components: menus, HUD elements, export handling.

## Files

| File | Purpose |
|------|---------|
| `index.ts` | Main UI class: menu handling, export, auto-save, load game |

## Subdirectories

| Directory | Purpose |
|-----------|---------|
| `bag/` | Color block selection toolbar (bottom HUD) |
| `fps/` | FPS counter display |
| `joystick/` | Mobile touch controls (disabled in MVP) |

## UI Class Key Responsibilities

1. **Menu System** - Play/Resume, Load Game, Controls, Settings, Export, Exit
2. **Export Handling** - Serialize to Space JSON, POST to backend, download .rbxlx
3. **Auto-save** - 10-second interval to localStorage
4. **Load Game** - Restore blocks, camera position/quaternion from localStorage
5. **Block Counter** - Display user-placed block count with warning at >8000

## Bag Subdirectory (`bag/`)

| File | Purpose |
|------|---------|
| `index.ts` | Bag class: 10 color squares (1-9, 0 keys), selection highlighting |

Color palette order:
1. Red, 2. Orange, 3. Yellow, 4. Green, 5. Blue, 6. Violet, 7. Brown, 8. White, 9. Gray, 0. Black

## FPS Subdirectory (`fps/`)

| File | Purpose |
|------|---------|
| `index.ts` | FPS class: calculates and displays frames per second |

## Joystick Subdirectory (`joystick/`)

| File | Status | Purpose |
|------|--------|---------|
| `index.ts` | Disabled | Mobile touch controls (import removed in MVP) |
| `joystick.html` | Disabled | HTML template for touch controls |

## localStorage Keys

| Key | Data |
|-----|------|
| `block` | JSON array of all customBlocks (including ground) |
| `seed` | Noise seed (legacy, for procedural terrain) |
| `camera` | Position (x,y,z) and quaternion (x,y,z,w) |
| `position` | Legacy: position only (backward compatibility) |

## Export Flow

1. Click Export button -> `handleExport()`
2. Show loading overlay
3. `serializeToSpaceJSON(terrain.customBlocks, 1, 'Untitled Level')`
4. POST to `import.meta.env.VITE_API_URL || '/api/export'`
5. On success: trigger download of `level.rbxlx`
6. On error: show error message overlay

## Related Files

- Export serialization: `export/serialize.ts`
- Terrain (block data): `terrain/index.ts`
- Control (input handling): `control/index.ts`
